{{/* Sidebar TOC Widget - Desktop only */}}
{{ $TOCManuallyDisabled := eq .Context.Params.toc false }}
{{ $TOCGloballyEnabled := .Context.Site.Params.article.toc.enabled | default true }}
{{ $TOCEnabled := and (not $TOCManuallyDisabled) $TOCGloballyEnabled }}
{{ $hasTOC := gt (len .Context.TableOfContents) 0 }}
{{ $minHeadings := .Context.Site.Params.article.toc.minHeadings | default 1 }}
{{ $headingCount := len (findRE "<li>" .Context.TableOfContents) }}
{{ $hasEnoughHeadings := ge $headingCount $minHeadings }}
{{ $showTOC := and $TOCEnabled $hasTOC $hasEnoughHeadings }}



{{ if $showTOC }}
    <section class="bg-card-bg rounded-card p-4 lg:p-6 shadow-l1 mb-6 lg:mb-8 toc-widget hidden lg:block border border-card-separator/30 hover:shadow-l3 transition-all duration-400 hover:border-accent/30 hover:bg-card-bg-selected/50 group animate-fade-in hover-lift backdrop-blur-sm">
        <!-- Enhanced TOC header with gradient accent -->
        <div class="relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-r from-accent/5 via-transparent to-accent/5 opacity-0 group-hover:opacity-100 transition-opacity duration-400"></div>
            {{ partial "article/components/toc-core" (dict 
                "context" .Context
                "id_prefix" "sidebar-toc"
                "show_toggle" false
                "toggle_classes" ""
                "wrapper_classes" "relative z-10"
                "content_classes" ""
            ) }}
        </div>

    </section>
{{ end }}