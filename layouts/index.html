{{ define "body-class" }}homepage{{ end }}

{{ define "main" }}
    {{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
    {{ $notHidden := where .Site.RegularPages "Params.hidden" "!=" true }}
    {{ $filtered := ($pages | intersect $notHidden) }}
    {{ $pag := .Paginate ($filtered) }}


    {{/* Use the modular post listing component with search functionality */}}
    {{ partial "post-listing.html" (dict "Context" . "Pages" $pag.Pages "SearchMode" true) }}

    {{- partial "pagination.html" . -}}
    {{- partial "footer/footer" . -}}

    {{/* Load search script and data for inline search functionality */}}
    <script>
        window.searchResultTitleTemplate = "{{ T `search.resultTitle` | default `Found #PAGES_COUNT results in #TIME_SECONDS seconds` }}"
    </script>

    {{- $opts := dict "minify" hugo.IsProduction "JSXFactory" "createElement" "target" "es2020" -}}
    {{- $searchScript := resources.Get "ts/search.ts" | js.Build $opts -}}
    <script type="text/javascript" src="{{ $searchScript.RelPermalink }}" defer></script>
{{ end }}