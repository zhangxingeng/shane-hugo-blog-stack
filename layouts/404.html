{{ define "main" }}
    <header>
        <h1 class="text-center text-4xl font-bold">404</h1>
        <p class="text-center text-xl text-card-text-secondary">Page not found</p>
    </header>
    <section class="flex-grow space-y-6">
        <div class="bg-card-bg rounded-card p-8 text-center shadow-l1 mb-8">
            <h1 class="text-lg font-semibold text-card-text mb-2">{{ T "notFound.title" }}</h1>
            <h2 class="text-base text-card-text-secondary mb-4">{{ T "notFound.subtitle" }}</h2>
        </div>

        {{- $byLang := where .Site.Pages "Lang" .Site.Language.Lang -}}
        {{- $query := first 1 (where $byLang "Layout" "==" "search") -}}
        {{- $searchPage := index $query 0 -}}

        {{- with $searchPage -}}
            <form action="{{ $searchPage.RelPermalink }}" class="search-form widget bg-card-bg rounded-card p-4 shadow-l1" {{ with $searchPage.OutputFormats.Get "json" -}}data-json="{{ .Permalink }}" {{- end }}>
                <p class="relative m-0">
                    <label class="absolute top-2 left-4 text-sm font-medium text-card-text-tertiary">{{ T "search.title" }}</label>
                    <input id="searchInput" name="keyword" required placeholder="{{ T `search.placeholder` }}" 
                           class="w-full pt-7 pb-3 px-4 pr-12 border border-card-separator rounded-card bg-card-bg text-card-text placeholder-card-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-200" />
                    <button type="submit" title="{{ T `search.title` }}" 
                            class="absolute right-2 top-1/2 transform -translate-y-1/2 p-2 text-card-text-tertiary hover:text-accent transition-colors duration-200 cursor-pointer bg-transparent border-0">
                        {{ partial "helper/icon" "search" }}
                    </button>
                </p>
            </form>

            <div class="search-result mt-8">
                <h3 class="search-result--title text-xl font-semibold text-card-text mb-4"></h3>
                <div class="search-result--list space-y-4"></div>
            </div>
            
            <script>
                window.searchResultTitleTemplate = "{{ T `search.resultTitle` }}"
            </script>

            {{- $opts := dict "minify" hugo.IsProduction "JSXFactory" "createElement" "target" "es2020" -}}
            {{- $searchScript := resources.Get "ts/search.ts" | js.Build $opts -}}
            <script type="text/javascript" src="{{ $searchScript.RelPermalink }}" defer></script>

            <script>
                const wrongUrl = new URL(window.location.href);

                /// Get the search keyword from the wrong URL by removing all slashes and dashes
                const searchKeyword = wrongUrl.pathname.split(/[/|-]/).join(' ').trim();

                document.getElementById('searchInput').setAttribute('value', searchKeyword);
            </script>
        {{- end -}}
    </section>
    {{ partialCached "footer/footer" . }}
{{ end }}

{{ define "right-sidebar" }}
    {{/* 404 page doesn't use right sidebar */}}
{{ end }}